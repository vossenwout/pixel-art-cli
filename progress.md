- Completed T:1 scaffold: Go module, Cobra root command with --version, and unit tests for unknown command/usage and version.
- Tests/run: `go test ./...` and `go build ./cmd/pxcli` pass.
- Completed T:2 defaults/config: added `internal/config` with shared defaults/options, root `--socket` validation, and stub `start`/`daemon` commands with `--headless` flag; added unit tests for defaults and validation.
- Tests/run: `go test ./...` passes.
- Next: implement IPC protocol parsing (T:3) and begin command/daemon plumbing.
- Completed T:3 protocol parsing/formatting: added `internal/protocol` with ASCII-whitespace parsing, structured errors, response formatters, and unit tests.
- Tests/run: `go test ./...` passes.
- Next: implement color parsing/formatting (T:4) or canvas model (T:5).
- Completed T:4 color parsing/formatting: added `internal/color` with hex/named parsing, canonical formatting, structured errors, and unit tests.
- Tests/run: `go test ./...` passes.
- Next: implement canvas model (T:5) or drawing operations (T:6/T:7).
- Completed T:5 canvas model: added `internal/canvas` with bounds-checked get/set/clear, structured errors, and unit tests.
- Tests/run: `go test ./...` passes.
- Next: implement `fill_rect` (T:6) and `line` (T:7) drawing operations atop canvas.
- Completed T:6 fill_rect: added Canvas FillRect with size/bounds validation and unit tests for coverage/error codes.
- Tests/run: `go test ./...` passes.
- Completed T:7 line: added Canvas Line (Bresenham) with endpoint bounds validation and unit tests for horizontal/vertical/diagonal lines plus out_of_bounds errors.
- Tests/run: `go test ./...` passes.
- Completed T:8 undo/redo history: added canvas snapshot/restore support plus history manager with undo/redo/redo-clear behavior and unit tests for no_history errors.
- Tests/run: `go test ./...` passes.
- Completed T:9 PNG export: added canvas ExportPNG with PNG encoding and unit tests for pixel fidelity + io errors.
- Tests/run: `go test ./...` passes.
- Completed T:10 command handler: added daemon handler mapping protocol requests to canvas operations, error mapping, and stop callback support with unit tests.
- Tests/run: `go test ./...` passes.
- Completed T:11 socket server: added Unix domain socket server handling one request per connection plus integration tests for newline response and invalid requests.
- Tests/run: `go test ./...` passes.
- Completed T:12 PID + stale socket handling: added daemon startup helpers with injectable liveness/dialer checks plus unit tests; includes PID write/cleanup helpers.
- Tests/run: `go test ./...` passes.
- Completed T:13 graceful shutdown: added daemon runtime with stop/signal handling, cleanup of PID/socket, and tests for stop request + SIGINT shutdown.
- Tests/run: `go test ./...` passes.
- Completed T:14 headless runtime: added `daemon.RunHeadless` wiring canvas/history/server/runtime plus tests for command handling and DISPLAY unset.
- Tests/run: `go test ./...` passes.
- Completed T:15 daemon command: added size/scale validation, headless wiring, and CLI tests that start a headless daemon on a temp socket/PID.
- Tests/run: `go test ./...` passes.
- Next: implement client transport (T:16) and `pxcli start` command (T:17).
- Completed T:16 client transport: added `internal/client` with request/response handling, timeouts, and structured errors; added tests for ok response, missing socket, and timeout behavior.
- Tests/run: `go test ./...` passes.
- Next: implement `pxcli start` (T:17) and CLI command wiring.
- Completed T:17 start command: spawn daemon with validated size/scale/headless flags, wait for socket readiness, print PID, and handle daemon-already-running errors; added unit/integration coverage for start behavior/argv construction.
- Tests/run: `go test ./...` passes.
- Completed T:18 stop command: added `pxcli stop` to send stop requests, wait for socket/PID cleanup, and integration tests for stop + missing daemon errors.
- Tests/run: `go test ./...` passes.
- Completed T:19 CLI drawing commands: added `set_pixel`, `fill_rect`, `line`, `clear` commands with arg validation, request wiring, and mocked-client unit tests (flags are non-interspersed to allow negative numeric args).
- Tests/run: `go test ./...` passes.
- Completed T:20 CLI utility commands: added `get_pixel`/`export`, absolute path resolution for export, and tests covering get_pixel output plus export path/error handling.
- Tests/run: `go test ./...` passes.
- Completed T:21 CLI history commands: added `undo`/`redo` commands, request wiring tests, and integration coverage for undo/redo behavior.
- Tests/run: `go test ./...` passes.
- Completed T:22 end-to-end protocol integration tests: added headless socket harness covering drawing, export, undo/redo, and out_of_bounds errors with temp socket/PID paths.
- Tests/run: `go test ./...` passes.
- Completed T:24 race-free daemon concurrency: added locking to canvas/history and a concurrent-request headless runtime test.
- Tests/run: `go test -race ./...` and `go test ./...` pass.
- Completed T:23 documentation: added README with headless workflow, protocol summary, socket overrides, troubleshooting, and export path notes; added a docs test to ensure core workflow coverage.
- Tests/run: `go test ./...` passes.
- Verified T:17 acceptance criteria: added start command test for negative scale validation and aligned tasks checklist.
- Tests/run: `go test ./...` passes.
- Completed T:25 renderer abstraction: added Renderer interface + stub for non-ebiten builds, renderer availability checks, and CLI errors for `--headless=false` with tests for start/daemon.
- Tests/run: `go test ./...` and `go build ./cmd/pxcli` pass.
- Completed T:26 rendering snapshot/dirty tracking: added render snapshot API with RGBA byte copy + dirty flag tracking on all mutations, plus unit tests for snapshot content/copy semantics and dirty reset.
- Tests/run: `go test -race ./...` passes.
- Implemented T:27 windowed renderer: added Ebiten renderer + windowed runtime wiring, headless/renderer selection in daemon command, and a scale calculation test.
- Tests/run: `go test ./...` passes.
- Note: `go build -tags=ebiten ./cmd/pxcli` fails in the container (missing GL/X11 dev libs via pkg-config); verify windowed build locally.
- Completed T:29 windowed docs: updated README with `-tags=ebiten` build/run steps and local-only GUI verification notes; extended docs test coverage.
- Tests/run: `go test ./...` passes.
- Completed T:28 window/daemon lifecycle coordination: factored shared windowed runtime wiring, ensured stop requests trigger renderer close, and added tests for stop/close cleanup with a fake renderer.
- Tests/run: `go test ./...` passes.
- Finalized T:27 Ebiten renderer verification: fixed nearest-neighbor scaling to use DrawImageOptions filter, confirmed `go build -tags=ebiten ./cmd/pxcli` in container, and exercised windowed daemon under Xvfb (stop returned ok).
- Tests/run: `go test ./...` passes; `go test -tags=ebiten ./internal/daemon` passes with Xvfb.
